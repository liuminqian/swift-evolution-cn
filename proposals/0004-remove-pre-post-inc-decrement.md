移除`++`和`--`操作符
---

* 提议: [SE-0004](https://github.com/apple/swift-evolution/blob/master/proposals/0004-remove-pre-post-inc-decrement.md)
* 作者: [Chris Lattner](https://github.com/lattner)
* 状态: **Acceppted**

## 引言

`++`和`--`操作符在Swift开发非常早期的时候就增加了，从C语言保留下来。增加的时候并没有很多的考虑，之后也没思考更多。本文提供了新视角来看待这两个操作符，并最终推荐全部移除掉他们。这是因为他们让人困惑，并且没有分量。

快速回顾下，`++`和`--`的四个场景：

```swift
let a = ++x  // 前增  - 改变后返回输入值
let b = x++  // 后增 - 改变前返回输入值的拷贝
let c = --x  // 前减  - 改变后返回输入值
let d = x--  // 后减 - 改变前返回输入值的拷贝
```
不过，这些操作符的结果值是经常被忽略的。


## 这些操作符的优势

这些操作符的主要优势是他们的表达能力。他们是某些场景下的简写，如数值类型的`x += 1`，或者迭代值的`x.advance()` 。 当需要返回值的时候，Swift`+=`操作符不能写在一行代码里，因为（不像C）他返回`Void`。

第二个优势是C系语言(C, C++, Objective-C, Java, C#, Javascript等)的延续。从这些语言过来的人可能想也存在这些操作符。这也就是说，也存在流行语言保持了大部分C操作符，但舍弃了这些操作符的，如Python。

## 这些操作符的劣势

1. 这些操作符加大了Swift初学者的学习负担－或者来自哪些没有这些操作符的语言的人。

2. 他们的表达优势是最小化-`x++`，然并没有比`x += 1`短多少.

3. Swift 已经偏离了C，如`=`, `+=` 和其它赋值操作符，因为大量的理由，返回了`Void` ()。这些操作符和那模型是不连续的了。

4. Swift 有很牛逼的功能来消除你在其它语言中C风格for-loop里使用的`++i`，这样在优雅的Swift代码中这些操作符相对是低频的。这些功能包括`for-in`循环, ranges, `enumerate`, `map`等等。

5. 使用了这些操作符的返回值的代码经常让人困惑，对可读性和可维护性都提高了难度。他们鼓吹了“overly tricky”代码，这可能是机智的，但很难理解。

6. 当Swift很好的定义了评估的顺序，任何依赖他的(如`foo(++a, a++)`)代码都是不得人心的，即使他定义的很好。

7. 这些操作符的只能应用到少数类型：整型、浮点标量，和类似迭代的概念。他们不能应用到复数，矩阵等。

最后，他们没通过公理："if we didn't already have these, would we add them to Swift 3?"。


## 提议的解决方案


我们应该全部丢弃这些操作符。将在春季Swift 2.x 发布中deprecate他们(有个漂亮的修复建议来覆盖大多场景)，并从Swift 3完全移除。

## 另外的选择

最简单的选择就是保留他们。更有趣的思考是，让这些操作符都返回Void。这解决了上述的部分问题，但也引入了新问题：一旦没了返回值，那么前后的区别也就消失了。基于此，我们不得不在这些不走运的选择中做出选择：

1) 保留 `x++` 和 `++x`，即使他们做了同样的事情。
2) 丢弃 `x++` 或者 `++x`其中一个。  C++ 程序员一般优先选择前缀的形式，但是其他人一般会选择后缀的形式。丢弃任意一个都是偏离了C。

尽管仔细考虑了这些选择，但是他们都没能抵消Swift增加这些操作符带来的复杂性。
